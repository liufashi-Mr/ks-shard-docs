# @ks-console/shared ç»„ä»¶åº“ä»‹ç»

## æ¦‚è¿°

`@ks-console/shared` æ˜¯ KubeSphere æ§åˆ¶å°çš„æ ¸å¿ƒå…±äº«ç»„ä»¶åº“ï¼Œä¸º KubeSphere å¹³å°æä¾›äº†ä¸€å¥—å®Œæ•´çš„ã€å¯å¤ç”¨çš„ React ç»„ä»¶å’Œå·¥å…·å‡½æ•°ã€‚è¯¥åº“ä¸“é—¨ä¸º Kubernetes å’Œäº‘åŸç”Ÿåº”ç”¨ç®¡ç†åœºæ™¯è®¾è®¡ï¼ŒåŒ…å«äº†ä¸°å¯Œçš„ UI ç»„ä»¶ã€çŠ¶æ€ç®¡ç†ã€å·¥å…·å‡½æ•°å’Œè‡ªå®šä¹‰ Hooksã€‚

## ç‰ˆæœ¬ä¿¡æ¯

- **å½“å‰ç‰ˆæœ¬**: `0.0.0-canary.20250617082329`
- **è®¸å¯è¯**: SEE LICENSE IN LICENSE
- **æ¨¡å—ç±»å‹**: ES Module
- **TypeScript æ”¯æŒ**: å®Œæ•´æ”¯æŒ

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ **ä¸“ä¸º Kubernetes è®¾è®¡**
- å†…ç½® Kubernetes èµ„æºç®¡ç†ç»„ä»¶
- æ”¯æŒ Podã€Deploymentã€Service ç­‰æ ¸å¿ƒèµ„æº
- æä¾›é›†ç¾¤ã€é¡¹ç›®ã€å·¥ä½œç©ºé—´ç®¡ç†åŠŸèƒ½

### ğŸ§© **ä¸°å¯Œçš„ UI ç»„ä»¶**
- æ•°æ®è¡¨æ ¼å’Œåˆ—è¡¨ç»„ä»¶
- æ¨¡æ€æ¡†å’Œç¡®è®¤å¯¹è¯æ¡†
- çŠ¶æ€æŒ‡ç¤ºå™¨å’Œè¿›åº¦æ¡
- å›¾è¡¨å’Œç›‘æ§ç»„ä»¶
- å¸ƒå±€å’Œå¯¼èˆªç»„ä»¶

### ğŸ”§ **å¼ºå¤§çš„å·¥å…·å‡½æ•°**
- API è¯·æ±‚å’Œæ•°æ®å¤„ç†
- è¡¨å•éªŒè¯å’Œæ ¼å¼åŒ–
- æ—¶é—´å¤„ç†å’ŒçŠ¶æ€ç®¡ç†
- æ–‡ä»¶æ“ä½œå’Œç¼–ç è½¬æ¢

### ğŸ£ **è‡ªå®šä¹‰ Hooks**
- åˆ—è¡¨æ•°æ®ç®¡ç†
- WebSocket è¿æ¥
- æ¨¡æ€æ¡†æ§åˆ¶
- ç¼“å­˜ç®¡ç†

## ä¸»è¦æ¨¡å—

### 1. ç»„ä»¶ (Components)

#### æ•°æ®å±•ç¤ºç»„ä»¶
- **DataTable**: åŠŸèƒ½å¼ºå¤§çš„æ•°æ®è¡¨æ ¼ç»„ä»¶
- **List**: åˆ—è¡¨ç»„ä»¶ï¼Œæ”¯æŒåˆ†é¡µå’Œæœç´¢
- **RankTable**: æ’åè¡¨æ ¼ç»„ä»¶
- **Pagination**: åˆ†é¡µç»„ä»¶

#### çŠ¶æ€å’ŒæŒ‡ç¤ºå™¨
- **StatusIndicator**: çŠ¶æ€æŒ‡ç¤ºå™¨ï¼Œæ”¯æŒå¤šç§çŠ¶æ€æ˜¾ç¤º
- **StatusReason**: çŠ¶æ€åŸå› å±•ç¤º
- **PodIndicator**: Pod çŠ¶æ€æŒ‡ç¤ºå™¨
- **VolumeStatus**: å­˜å‚¨å·çŠ¶æ€

#### å¸ƒå±€ç»„ä»¶
- **WorkspaceLayout**: å·¥ä½œç©ºé—´å¸ƒå±€
- **ProjectLayout**: é¡¹ç›®å¸ƒå±€
- **DetailPage**: è¯¦æƒ…é¡µé¢å¸ƒå±€
- **ListPage**: åˆ—è¡¨é¡µé¢å¸ƒå±€

#### è¾“å…¥ç»„ä»¶
- **Inputs**: å„ç§è¾“å…¥ç»„ä»¶
- **TimeSelector**: æ—¶é—´é€‰æ‹©å™¨
- **UrlInput**: URL è¾“å…¥æ¡†
- **TextPreview**: æ–‡æœ¬é¢„è§ˆ

#### æ¨¡æ€æ¡†ç»„ä»¶
- **Confirm**: ç¡®è®¤å¯¹è¯æ¡†
- **DeleteConfirm**: åˆ é™¤ç¡®è®¤
- **EditYamlModal**: YAML ç¼–è¾‘æ¨¡æ€æ¡†
- **ContainerTerminal**: å®¹å™¨ç»ˆç«¯

#### å…¶ä»–ç»„ä»¶
- **Avatar**: å¤´åƒç»„ä»¶
- **Image**: å›¾ç‰‡ç»„ä»¶
- **Lightbox**: å›¾ç‰‡æŸ¥çœ‹å™¨
- **Markdown**: Markdown æ¸²æŸ“å™¨
- **Terminal**: ç»ˆç«¯ç»„ä»¶

### 2. Hooks

#### æ•°æ®ç®¡ç†
- **useList**: åˆ—è¡¨æ•°æ®ç®¡ç†
- **useDataTable**: æ•°æ®è¡¨æ ¼ç®¡ç†
- **useListQueryParams**: æŸ¥è¯¢å‚æ•°ç®¡ç†

#### çŠ¶æ€ç®¡ç†
- **useModal**: æ¨¡æ€æ¡†çŠ¶æ€ç®¡ç†
- **useCache**: ç¼“å­˜ç®¡ç†
- **useEventEmitter**: äº‹ä»¶å‘å°„å™¨

#### ä¸šåŠ¡é€»è¾‘
- **useActions**: æ“ä½œç®¡ç†
- **useActionMenu**: æ“ä½œèœå•
- **useWorkspaceSelect**: å·¥ä½œç©ºé—´é€‰æ‹©
- **useProjectSelect**: é¡¹ç›®é€‰æ‹©

#### ç½‘ç»œå’Œé€šä¿¡
- **useWebSocket**: WebSocket è¿æ¥
- **useUrl**: URL ç®¡ç†
- **useInterval**: å®šæ—¶å™¨ç®¡ç†

### 3. å·¥å…·å‡½æ•° (Utils)

#### API å’Œç½‘ç»œ
- **request**: HTTP è¯·æ±‚å·¥å…·
- **apis**: API æ¥å£å®šä¹‰
- **websocket.client**: WebSocket å®¢æˆ·ç«¯

#### æ•°æ®å¤„ç†
- **formatter**: æ•°æ®æ ¼å¼åŒ–
- **parser**: æ•°æ®è§£æ
- **getter**: æ•°æ®è·å–å™¨
- **checker**: æ•°æ®æ£€æŸ¥

#### Kubernetes ç›¸å…³
- **clusterParser**: é›†ç¾¤è§£æå™¨
- **status**: çŠ¶æ€å¤„ç†
- **monitoring**: ç›‘æ§å·¥å…·
- **workloads**: å·¥ä½œè´Ÿè½½å·¥å…·

#### é€šç”¨å·¥å…·
- **common**: é€šç”¨å‡½æ•°
- **time**: æ—¶é—´å¤„ç†
- **base64**: Base64 ç¼–ç 
- **yaml**: YAML å¤„ç†
- **cookie**: Cookie ç®¡ç†

### 4. çŠ¶æ€ç®¡ç† (Stores)

#### æ ¸å¿ƒèµ„æº
- **pod**: Pod èµ„æºç®¡ç†
- **deployment**: Deployment ç®¡ç†
- **service**: Service ç®¡ç†
- **configmap**: ConfigMap ç®¡ç†
- **secret**: Secret ç®¡ç†

#### é›†ç¾¤ç®¡ç†
- **cluster**: é›†ç¾¤ç®¡ç†
- **node**: èŠ‚ç‚¹ç®¡ç†
- **namespace**: å‘½åç©ºé—´ç®¡ç†

#### åº”ç”¨ç®¡ç†
- **apps**: åº”ç”¨ç®¡ç†
- **devops**: DevOps ç®¡ç†
- **marketplace**: åº”ç”¨å•†åº—

#### ç›‘æ§å’Œè¿ç»´
- **monitoring**: ç›‘æ§æ•°æ®
- **event**: äº‹ä»¶ç®¡ç†
- **log**: æ—¥å¿—ç®¡ç†

## ä¾èµ–å…³ç³»

### æ ¸å¿ƒä¾èµ–
- **@tanstack/react-table**: è¡¨æ ¼ç»„ä»¶åº“
- **axios**: HTTP å®¢æˆ·ç«¯
- **zustand**: çŠ¶æ€ç®¡ç†
- **react-markdown**: Markdown æ¸²æŸ“
- **xterm**: ç»ˆç«¯æ¨¡æ‹Ÿå™¨

### å¯¹ç­‰ä¾èµ–
- **@kubed/charts**: å›¾è¡¨ç»„ä»¶
- **@kubed/code-editor**: ä»£ç ç¼–è¾‘å™¨
- **@kubed/log-viewer**: æ—¥å¿—æŸ¥çœ‹å™¨

## ä½¿ç”¨åœºæ™¯

### 1. Kubernetes èµ„æºç®¡ç†
```tsx
import { DataTable, StatusIndicator, useList } from '@ks-console/shared';

// ç®¡ç† Pod åˆ—è¡¨
const PodList = () => {
  const { data, loading } = useList('pods');
  
  return (
    <DataTable
      data={data}
      loading={loading}
      columns={[
        { key: 'name', title: 'åç§°' },
        { key: 'status', title: 'çŠ¶æ€', render: (status) => <StatusIndicator status={status} /> }
      ]}
    />
  );
};
```

### 2. å·¥ä½œç©ºé—´ç®¡ç†
```tsx
import { WorkspaceLayout, useWorkspaceSelect } from '@ks-console/shared';

// å·¥ä½œç©ºé—´å¸ƒå±€
const WorkspaceApp = () => {
  const { workspace } = useWorkspaceSelect();
  
  return (
    <WorkspaceLayout workspace={workspace}>
      {/* å·¥ä½œç©ºé—´å†…å®¹ */}
    </WorkspaceLayout>
  );
};
```

### 3. æ¨¡æ€æ¡†æ“ä½œ
```tsx
import { useModal, Confirm, EditYamlModal } from '@ks-console/shared';

// ä½¿ç”¨æ¨¡æ€æ¡†
const App = () => {
  const { openModal } = useModal();
  
  const handleDelete = () => {
    openModal(Confirm, {
      title: 'ç¡®è®¤åˆ é™¤',
      content: 'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªèµ„æºå—ï¼Ÿ',
      onConfirm: () => {
        // åˆ é™¤é€»è¾‘
      }
    });
  };
  
  const handleEditYaml = () => {
    openModal(EditYamlModal, {
      yaml: resourceYaml,
      onSave: (newYaml) => {
        // ä¿å­˜é€»è¾‘
      }
    });
  };
};
```

## æœ€ä½³å®è·µ

### 1. ç»„ä»¶ä½¿ç”¨
- ä¼˜å…ˆä½¿ç”¨åº“æä¾›çš„ç»„ä»¶ï¼Œé¿å…é‡å¤é€ è½®å­
- åˆ©ç”¨ç»„ä»¶çš„ TypeScript ç±»å‹å®šä¹‰ï¼Œç¡®ä¿ç±»å‹å®‰å…¨
- éµå¾ªç»„ä»¶çš„ API è®¾è®¡ï¼Œä¿æŒä¸€è‡´æ€§

### 2. çŠ¶æ€ç®¡ç†
- ä½¿ç”¨ `useList` ç®¡ç†åˆ—è¡¨æ•°æ®ï¼Œè‡ªåŠ¨å¤„ç†åˆ†é¡µå’Œæœç´¢
- åˆ©ç”¨ `useModal` ç»Ÿä¸€ç®¡ç†æ¨¡æ€æ¡†çŠ¶æ€
- åˆç†ä½¿ç”¨ç¼“å­˜ï¼Œæå‡ç”¨æˆ·ä½“éªŒ

### 3. å·¥å…·å‡½æ•°
- ä½¿ç”¨å†…ç½®çš„æ ¼å¼åŒ–å‡½æ•°å¤„ç†æ•°æ®å±•ç¤º
- åˆ©ç”¨ API å·¥å…·å‡½æ•°å¤„ç†ç½‘ç»œè¯·æ±‚
- ä½¿ç”¨éªŒè¯å‡½æ•°ç¡®ä¿æ•°æ®æ­£ç¡®æ€§

### 4. æ€§èƒ½ä¼˜åŒ–
- åˆç†ä½¿ç”¨ `useMemo` å’Œ `useCallback`
- é¿å…åœ¨æ¸²æŸ“å‡½æ•°ä¸­åˆ›å»ºæ–°å¯¹è±¡
- ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨å¤„ç†å¤§é‡æ•°æ®

## æ‰©å±•å¼€å‘

### 1. è‡ªå®šä¹‰ç»„ä»¶
```tsx
import { BaseTable } from '@ks-console/shared';

// åŸºäºåŸºç¡€ç»„ä»¶å¼€å‘è‡ªå®šä¹‰ç»„ä»¶
const CustomTable = (props) => {
  return (
    <BaseTable
      {...props}
      // è‡ªå®šä¹‰é…ç½®
    />
  );
};
```

### 2. è‡ªå®šä¹‰ Hook
```tsx
import { useList } from '@ks-console/shared';

// åŸºäºåŸºç¡€ Hook å¼€å‘è‡ªå®šä¹‰ Hook
const useCustomList = (resource) => {
  const listHook = useList(resource);
  
  // è‡ªå®šä¹‰é€»è¾‘
  return {
    ...listHook,
    // æ‰©å±•åŠŸèƒ½
  };
};
```

## æ€»ç»“

`@ks-console/shared` æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€è®¾è®¡è‰¯å¥½çš„ Kubernetes ç®¡ç†ç»„ä»¶åº“ï¼Œä¸º KubeSphere å¹³å°æä¾›äº†å¼ºå¤§çš„åŸºç¡€èƒ½åŠ›ã€‚é€šè¿‡åˆç†ä½¿ç”¨è¯¥åº“çš„ç»„ä»¶ã€Hooks å’Œå·¥å…·å‡½æ•°ï¼Œå¯ä»¥å¿«é€Ÿæ„å»ºé«˜è´¨é‡çš„ Kubernetes ç®¡ç†ç•Œé¢ï¼Œæå‡å¼€å‘æ•ˆç‡å’Œç”¨æˆ·ä½“éªŒã€‚

è¯¥åº“ä¸ä»…æä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œè¿˜å…·æœ‰è‰¯å¥½çš„å¯æ‰©å±•æ€§ï¼Œæ”¯æŒæ ¹æ®å…·ä½“éœ€æ±‚è¿›è¡Œå®šåˆ¶å’Œæ‰©å±•ã€‚æ— è®ºæ˜¯æ„å»ºæ–°çš„ç®¡ç†ç•Œé¢ï¼Œè¿˜æ˜¯æ‰©å±•ç°æœ‰åŠŸèƒ½ï¼Œ`@ks-console/shared` éƒ½æ˜¯ä¸€ä¸ªå€¼å¾—ä¿¡èµ–çš„é€‰æ‹©ã€‚ 